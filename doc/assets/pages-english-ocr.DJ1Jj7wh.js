import{d as s,r as e,c as a,w as t,i as l,o,a as c,j as n,e as r,f as i,F as u,g as f,b as p,t as d,k as m,l as v,m as h,s as w,p as g,q as y,u as _,v as C,x,y as L}from"./index-DGVV8rsx.js";import{i as b,g as F}from"./common.CtEHOdL_.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const k=j(s({__name:"ocr",setup(s){const j=e(""),k=e(""),z=()=>{h({count:1,sizeType:["compressed"],sourceType:["album"],success:function(s){console.log(JSON.stringify(s.tempFilePaths)),j.value=s.tempFilePaths[0],console.log(j.value),B()}})},B=async()=>{var s;if(!j.value)return void w({title:"请先选择图片",icon:"none"});g({title:"文字识别中..."});const e=await async function(s){try{return new Promise((e,a)=>{_({url:s,responseType:"arraybuffer",success:s=>{const t=s.data;if(t instanceof ArrayBuffer){const s=C(t);e(`data:image/jpeg;base64,${s}`)}else a()},fail:s=>{console.error("H5 请求失败:",s),a()}})})}catch(e){throw console.error("转换失败:",e),e}}(j.value),a=await b(e);console.log(null==a?void 0:a.content),k.value=null==(s=null==a?void 0:a.content)?void 0:s.split("\n").filter(s=>s.trim().length>0),y()};const O=()=>{const s="my-favorite-words",e=x(s);let a=[];e&&(a=JSON.parse(e));const t=[...a,...k.value],l=t.filter((s,e)=>t.indexOf(s)===e);L(s,JSON.stringify(l))},J=s=>{F(s)};return(s,e)=>{const h=n,w=l,g=p,y=v;return o(),a(w,{class:"ocr-page"},{default:t(()=>[c(w,null,{default:t(()=>[c(h,{type:"primary",onClick:z},{default:t(()=>[r("上传图片识别")]),_:1})]),_:1}),c(w,{class:"show-image-and-texts"},{default:t(()=>[c(w,{class:"show-texts"},{default:t(()=>[(o(!0),i(u,null,f(k.value,s=>(o(),a(w,{class:"show-text"},{default:t(()=>[c(g,null,{default:t(()=>[r(d(s.toLocaleLowerCase()),1)]),_:2},1024),(o(),i("svg",{onClick:e=>J(s.toLocaleLowerCase()),t:"1763374183534",class:"icon",viewBox:"0 0 1025 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3316",width:"16",height:"16"},[m("path",{d:"M336.457143 336.457143m-336.457143 0a336.457143 336.457143 0 1 0 672.914286 0 336.457143 336.457143 0 1 0-672.914286 0Z",fill:"#8CF6FB","p-id":"3317"}),m("path",{d:"M592.457143 1024c-11.702857 0-21.942857-4.388571-30.72-13.165714 0 0-333.531429-175.542857-337.92-175.542857H93.622857c-48.274286 0-87.771429-39.497143-87.771428-87.771429V296.96c0-48.274286 39.497143-87.771429 86.308571-87.771429h131.657143L561.737143 13.165714c7.314286-8.777143 19.017143-13.165714 30.72-13.165714 23.405714 0 43.885714 19.017143 43.885714 43.885714v936.228572c0 24.868571-19.017143 43.885714-43.885714 43.885714z m-29.257143-921.6L269.165714 269.165714c-13.165714 8.777143-27.794286 14.628571-42.422857 14.628572h-131.657143c-7.314286 0-14.628571 5.851429-14.628571 14.628571v452.022857c0 7.314286 5.851429 14.628571 14.628571 14.628572h130.194286c8.777143 0 17.554286 1.462857 26.331429 4.388571 11.702857 5.851429 283.794286 137.508571 313.051428 156.525714L563.2 102.4z",fill:"#3C2DCB","p-id":"3318"}),m("path",{d:"M904.045714 792.868571c-7.314286 7.314286-16.091429 11.702857-26.331428 11.702858s-19.017143-4.388571-26.331429-10.24c-14.628571-14.628571-14.628571-36.571429 0-51.2 128.731429-128.731429 133.12-334.994286 5.851429-465.188572l-7.314286-7.314286c-14.628571-14.628571-14.628571-36.571429 0-51.2s38.034286-14.628571 52.662857 0c157.988571 153.6 160.914286 408.137143 7.314286 566.125715 0 2.925714-2.925714 4.388571-5.851429 7.314285z m-138.971428-102.4c-7.314286 7.314286-16.091429 10.24-26.331429 10.24s-19.017143-4.388571-26.331428-10.24c-14.628571-13.165714-14.628571-35.108571-1.462858-49.737142l1.462858-1.462858c70.217143-65.828571 74.605714-175.542857 8.777142-245.76l-8.777142-8.777142c-14.628571-13.165714-14.628571-35.108571-1.462858-49.737143l1.462858-1.462857c14.628571-14.628571 38.034286-14.628571 52.662857 0 98.011429 92.16 103.862857 245.76 11.702857 345.234285-4.388571 2.925714-7.314286 7.314286-11.702857 11.702857z",fill:"#D098FF","p-id":"3319"})],8,["onClick"]))]),_:2},1024))),256))]),_:1}),c(w,{class:"show-image"},{default:t(()=>[c(y,{src:j.value},null,8,["src"])]),_:1})]),_:1}),c(w,{class:"footer-btns"},{default:t(()=>[c(h,{type:"primary",onClick:e[0]||(e[0]=s=>J(k.value.join(" ").toLocaleLowerCase())),class:"btn"},{default:t(()=>[r("听全文")]),_:1}),c(h,{type:"primary",onClick:O,class:"btn"},{default:t(()=>[r("收藏所有单词")]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-e50fe8ce"]]);export{k as default};
